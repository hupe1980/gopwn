package main

import (
	"fmt"
	"strings"

	"github.com/hupe1980/gopwn"
)

const bin = "./challenge"

func main() {
	elf, _ := gopwn.NewELF(bin)
	for _, str := range elf.Strings(func(o *gopwn.StringsOptions) {
		o.Min = 10
		o.Max = 10
	}) {
		p, _ := gopwn.NewProcess([]string{bin})
		p.RecvLine() // `Input the password`
		p.SendLine(str)
		b, _ := p.RecvLine()
		if strings.Contains(string(b), "Correct") {
			fmt.Println("Password =", str)
			break
		}
	}
}
